<div class="container maincontent">

  <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
      <h1 class="intro">Report an encounter</h1>

      <p>
        Use the online form below to record the details of your encounter. Be as accurate and specific as possible. Please note that by submitting data and images, you are granting unlimited usage of these materials for research and conservation purposes only.
      </p>

      <p class="bg-danger text-danger">
        <strong>Note</strong>: The fields labelled in Red are required.
      </p>
  </div>

  <div class="col-xs-12 col-sm-7 col-md-7 col-lg-7">
    <iframe id="social_files_iframe" style="display: none;"></iframe>
      <form id="encounterForm" class="form-horizontal" action="EncounterForm" method="post" enctype="multipart/form-data" name="encounter_submission" target="_self" dir="ltr" lang="en" onsubmit="return false;">
      <div class="dz-message"></div>

      <!--
      <script>
        $('#social_files_iframe').on('load', function(ev) {
          if (!ev || !ev.target) return;
        //console.warn('ok!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');
          var doc = ev.target.contentDocument || ev.target.contentWindow.contentDocument;
        //console.warn('doc is %o', doc);
          if (!doc) return;
        //var x = $(doc).find('body').text();
        //console.warn('body %o', x);
          var j = JSON.parse($(doc).find('body').text());
          console.info('iframe returned %o', j);

          $('#encounterForm').append('<input type="hidden" name="social_files_id" value="' + j.id + '" />');
          //now do actual submit
          document.forms['encounterForm'].submit();
        });


        function socialPhotoGrab() {
        }


        function updateList(inp) {
            var f = '';
            if (inp.files && inp.files.length) {
                var all = [];
                for (var i = 0 ; i < inp.files.length ; i++) {
                    if (inp.files[i].size > 41943040) {
                        all.push('<span class="error">' + inp.files[i].name + ' (' + Math.round(inp.files[i].size / (1024*1024)) + 'MB is too big, 40MB max)</span>');
                    } else {
                        all.push(inp.files[i].name + ' (' + Math.round(inp.files[i].size / 1024) + 'k)');
                    }
                }
                f = '<b>' + inp.files.length + ' file' + ((inp.files.length == 1) ? '' : 's') + ':</b> ' + all.join(', ');
            } else {
                f = inp.value;
            }
            document.getElementById('input-file-list').innerHTML = f;
        }

        function showUploadBox() {
            $("#submitsocialmedia").addClass("hidden");
            $("#submitupload").removeClass("hidden");
        }

      </script>

      -->
    <fieldset>
      <h3>Footage</h3>
      <p>
        Add your photos and videos below. Photos can be selected from your computer or from your social media accounts.
      </p>

      <div class="center-block">
          <ul id="social_image_buttons" class="list-inline text-center">
            <li class="active">
              <button class="zocial icon" title="Upload from your computer" onclick="showUploadBox()" style="background:url(http://www.mantamatcher.org/images/computer.png);background-repeat: no-repeat;">
              </button>
          </li>
          <li>
              <button title="Import from flickr" class="zocial icon flickr"></button>
          </li>
          <li>
            <button title="Import from facebook" class="zocial icon facebook"></button>
          </li>
        </ul>
      </div>

      <div>
        <div id="submitupload" class="input-file-drop">

            <input class="nonIE" name="theFiles" type="file" accept=".jpg, .jpeg, .png, .bmp, .gif, .mov, .wmv, .avi, .mp4, .mpg" multiple="" size="30" onchange="updateList(this);">

            <div>
                Drag image/video files here, or click to open  file dialog
            </div>

            <div id="input-file-list"></div>
        </div>
        
        <div id="submitsocialmedia" class="social-media-btn container-fluid hidden">
          <div id="socialalbums" class="social-media-btn col-md-4"></div>
          <div id="socialphotos" class="social-media-btn col-md-8"></div>
        </div>

      </div>
  </fieldset>

  <hr/>

  <fieldset>
    <h3>Date and Location</h3>

    <div class="form-group required">
      
      <div class="form-inline col-xs-12 col-sm-12 col-md-6 col-lg-6">
        <label class="control-label text-danger">Encounter date</label>
        <input class="hasDatepicker form-control" type="text" style="position: relative; z-index: 101;" id="datepicker" name="datepicker" size="20">
      </div>

      <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
        <p class="help-block">
          Examples:
          <ul>
            <li>2014-01-05 12:30</li>
            <li>2014-03-23</li>
            <li>2013-12</li>
            <li>2010</li>
          </ul>
        </p>
      </div>

    </div>
  </fieldset>

  <hr/>

  <fieldset>
    <h3>Encounter location</h3>

    <div class="form-group required">  
      <div class="col-xs-6 col-sm-6 col-md-4 col-lg-4">
        <label class="control-label text-danger">Where were you?</label>
      </div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-8">
        <input name="location" type="text" id="location" size="40" class="form-control">
      </div>
    </div>

    <div class="form-group required">
      <div class="col-xs-6 col-sm-6 col-md-4 col-lg-4">
        <label class="control-label">Was this one of our study sites?</label>
      </div>
      
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-8">
        <select name="locationID" id="locationID" class="form-control">
            <option value="" selected="selected"></option>
            <option value="Australia (East)">Australia (East)</option>
            <option value="Australia (West)">Australia (West)</option>
            <option value="Brazil">Brazil</option>
            <option value="Costa Rica">Costa Rica</option>
            <option value="Ecuador">Ecuador</option>
            <option value="Fiji">Fiji</option>
            <option value="French Polynesia">French Polynesia</option>
            <option value="Galapagos">Galapagos</option>
            <option value="Guam">Guam</option>
            <option value="Hawaii">Hawaii</option>
            <option value="India">India</option>    
            <option value="Indonesia">Indonesia</option>
            <option value="Japan">Japan</option>
            <option value="Kenya">Kenya</option>
            <option value="Maldives">Maldives</option>
            <option value="Mexico (Revillagigedos)">Mexico (Revillagigedos)</option>
            <option value="Mexico (Yucatan)">Mexico (Yucatan)</option>
            <option value="Mozambique">Mozambique</option>
            <option value="Myanmar">Myanmar</option>
            <option value="New Caledonia">New Caledonia</option>
            <option value="New Zealand">New Zealand</option>
            <option value="Palau">Palau</option>
            <option value="Papua New Guinea">Papua New Guinea</option>
            <option value="Peru">Peru</option>
            <option value="Philippines">Philippines</option>
            <option value="Portugal (Azores)">Portugal (Azores)</option>
            <option value="Red Sea">Red Sea</option>
            <option value="Saudi Arabia">Saudi Arabia</option>
            <option value="Seychelles">Seychelles</option>
            <option value="South Africa">South Africa</option>
            <option value="Thailand">Thailand</option>
            <option value="USA (East coast)">USA (East coast)</option>
            <option value="USA (Flower Gardens)">USA (Flower Gardens)</option>
            <option value="Yap">Yap</option>
          </select>
      </div>
    </div>

    <div>
      <p class="bg-danger text-danger">
        Map goes here
      </p>
      
    </div>

    <div>
      <div class=" form-group form-inline">
        <div class="col-xs-12 col-sm-6">
          <label class="control-label pull-left">GPS Latitude</label>
          <input class="form-control" name="lat" type="text" id="lat"> °
        </div>

        <div class="col-xs-12 col-sm-6">
          <label class="control-label  pull-left">GPS Longitude</label>
          <input class="form-control" name="longitude" type="text" id="longitude"> °
        </div>
      </div>

      <p class="help-block">
        GPS coordinates are in the decimal degrees format. Do you have GPS coordinates in a different format? <a href="http://www.csgnetwork.com/gpscoordconv.html" target="_blank">Click here to find a converter.</a>
      </p> 
    </div>

    <div class="form-inline">
      <label class="control-label">Sea floor depth at site</label>
      <input class="form-control" name="depth" type="text" id="depth">
      &nbsp;meters <br>
    </div>
  </fieldset>

  <hr />

  <fieldset>
    <div class="row">  
      <div class="col-xs-12 col-lg-6">
        <h3>About You</h3>
        <p class="help-block">Your contact information</p>
        <div class="form-group form-inline">
          <div class="col-xs-6 col-md-4">
            <label class="text-danger control-label">Name</label>
          </div>
          <div class="col-xs-6 col-lg-8">
            <input class="form-control" name="submitterName" type="text" id="submitterName" size="24" value="">
          </div>
        </div>

        <div class="form-group form-inline">

          <div class="col-xs-6 col-md-4">
            <label class="text-danger control-label">Email</label>
          </div>
          <div class="col-xs-6 col-lg-8">
            <input class="form-control" name="submitterEmail" type="text" id="submitterEmail" size="24" value="">
          </div>
        </div>
      </div>

      <div class="col-xs-12 col-lg-6">
        <h3>About the photographer</h3>
        <p class="help-block">
          If you didn't take these pictures
        </p>
        
        <div class="form-group form-inline">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Name</label>
          </div>
          <div class="col-xs-6 col-lg-8">
            <input class="form-control" name="photographerName" type="text" id="photographerName" size="24">
          </div>
        </div>

        <div class="form-group form-inline">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Email</label>
          </div>
          <div class="col-xs-6 col-lg-8">
            <input class="form-control" name="photographerEmail" type="text" id="photographerEmail" size="24">
          </div>
        </div>
      </div>

    </div>
  </fielset>

  <hr/>

  <fieldset>
    <div class="form-group">
      <div class="col-xs-6 col-md-4">
        <label class="control-label">Organization</label>
      </div>

      <div class="col-xs-6 col-lg-8">
        <input class="form-control" name="submitterOrganization" type="text" id="submitterOrganization" size="75" value="">
      </div>
    </div>

    <div class="form-group">
      <div class="col-xs-6 col-md-4">
        <label class="control-label">Project</label>
      </div>
      <div class="col-xs-6 col-lg-8">
        <input class="form-control" name="submitterProject" type="text" id="submitterProject" size="75" value="">
      </div>
    </div>
        
    <div class="form-group">
      <div class="col-xs-6 col-md-4">
        <label class="control-label">Additional comments</label>
      </div>
      <div class="col-xs-6 col-lg-8">
        <textarea class="form-control" name="comments" id="comments" rows="5"></textarea>
      </div>
    </div>
  </fieldset>
    
  <h4 class="accordion">
    <a href="javascript:animatedcollapse.toggle('advancedInformation')" style="text-decoration:none">
      <img src="http://www.mantamatcher.org/images/Black_Arrow_down.png" width="14" height="14" border="0" align="absmiddle">
      Do You Have Advanced Information?
    </a>
  </h4>

    <div id="advancedInformation" fade="1">
      <h3>About the manta</h3>
      <fieldset>
        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Sex</label>
          </div>

          <div class="col-xs-6 col-lg-8">
            <label class="radio-inline"> 
              <input type="radio" name="sex" value="male"> Male
            </label> 
            <label class="radio-inline">
              <input type="radio" name="sex" value="female"> Female
            </label>
            <label class="radio-inline"> 
              <input name="sex" type="radio" value="unknown" checked="checked"> Unknown
            </label>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Species</label>
          </div>

          <div class="col-xs-6 col-lg-8">
            <select class="form-control" name="genusSpecies" id="genusSpecies">
              <option value="" selected="selected">unknown</option>
              <option value="Manta birostris">Manta birostris</option>
              <option value="Manta alfredi">Manta alfredi</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Status</label>
          </div>

          <div class="col-xs-6 col-lg-8">
            <select class="form-control" name="livingStatus" id="livingStatus">
              <option value="alive" selected="selected">Alive</option>
              <option value="dead">Dead</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Observed behavior</label>
          </div>

          <div class="col-xs-6 col-lg-8">
            <input class="form-control" name="behavior" type="text" id="scars" size="75">
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Life stage is</label>
          </div>

          <div class="col-xs-6 col-lg-8">
            <select class="form-control" name="lifeStage" id="lifeStage">
              <option value="" selected="selected"></option>
              <option value="juvenile">juvenile</option>
              <option value="sub-adult">sub-adult</option>
              <option value="adult">adult</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label>Measurements</label>
          </div>
          
          <div class="col-xs-12 col-lg-8">      
            <table class="measurements">
              <tbody>
                <tr>
                  <th>Type</th>
                  <th>Size</th>
                  <th>Units</th>
                  <th>Sampling Protocol</th>
                </tr>

                <tr>
                  <td class="text-no-break">Disc width</td>
                  <td><input class="form-control" name="measurement(discwidth)" id="discwidth"><input type="hidden" name="measurement(discwidthunits)" value="meters"></td>
                  <td>Meters</td>
                  <td>
                    <select class="form-control" name="measurement(discwidthsamplingProtocol)">
                      <option value="samplingProtocol0">Estimated</option>
                      <option value="samplingProtocol1">Measured</option>
                      <option value="samplingProtocol2"></option>
                    </select>
                  </td>
              </tr>
            </tbody></table>
          </div>
        </div>

        <div class="form-group">
          <div class="col-xs-6 col-md-4">
            <label class="control-label">Noticeable scarring</label>
          </div>

          <div class="col-xs-6 col-lg-8"> 
            <input class="form-control" name="scars" type="text" id="scars" size="75">
          </div>
        </div>
      </fieldset>

      <hr/>

      <fieldset>
        <h3>Tags</h3>

        <div class="row">
          <div class="col-xs-12 col-lg-6">
              <h5>Physical Tags</h5>
              <div class="form-group form-inline">
                <div class="col-xs-6">
                  <label class="control-label">Tag number (left):</label>
                </div>
                <div class="col-xs-6">
                  <input class="form-control" name="metalTag(left)">
                </div>
              </div>

              <div class="form-group form-inline">
                <div class="col-xs-6">
                  <label class="control-label">Tag number (right):</label>
                </div>
                <div class="col-xs-6">
                  <input class="form-control" name="metalTag(right)">
                </div>
              </div>
          </div>
          
          <div class="col-xs-12 col-lg-6">
            <h5>Electronic Tag</h5>
                    
            <div class="form-group form-inline">
              <div class="col-xs-6">
                <label class="control-label">Serial number</label>
              </div>
              <div class="col-xs-6">
                <input class="form-control" name="acousticTagSerial">
              </div>
            </div>

            <div class="form-group form-inline">
              <div class="col-xs-6">
                <label class="control-label">ID</label>
              </div>
              <div class="col-xs-6">
                <input class="form-control" name="acousticTagId">
              </div>
            </div>  
          </div>       
                  
          <div class="col-xs-12 col-lg-6">
            <h5>Satellite Tag</h5>

            <div class="form-group form-inline">
              <div class="col-xs-6">
                <label class="control-label">Name</label>
              </div>
              <div class="col-xs-6">
                <select class="form-control" name="satelliteTagName">
                    <option value="Wild Life Computers">Wild Life Computers</option>
                    <option value="SirTack">SirTack</option>
                </select>
              </div>
            </div>

            <div class="form-group form-inline">
                <div class="col-xs-6">
                  <label class="control-label">Serial number</label>
                </div>
                <div class="col-xs-6">
                  <input class="form-control" name="satelliteTagSerial">
                </div>
              </div>

              <div class="form-group form-inline">
                <div class="col-xs-6">
                  <label class="control-label">Argos PTT Number</label>
                </div>
                <div class="col-xs-6">
                  <input class="form-control" name="satelliteTagArgosPttNumber">
                </div>
              </div>
          </div>
        </div>
      </fieldset>

      <hr/>
        
      <div class="form-group">  
        <label class="control-label">Other email addresses to inform of resightings and status</label>
        <input class="form-control" name="informothers" type="text" id="informothers" size="75">
        <p class="help-block">Note: Multiple email addresses can be entered in email fields, using commas as separators.</p>
      </div>

      <input name="submitterID" type="hidden" value="N/A"> 

      <p class="text-center">
        <button class="large" type="submit" form="encounterForm" id="submit-button">
          Send encounter report 
          <span class="button-icon" aria-hidden="true">
        </button>
      </p>

    </form>
  </div>

</div>